---
import BaseLayout from "./BaseLayout.astro";

export interface Props {
  title: string;
  description?: string;
  image?: string;
  tripSlug?: string;
}

const { title, description, image, tripSlug } = Astro.props;
---

<BaseLayout title={title} description={description} image={image} bodyClass="trip-page">
  <div class="trip-layout">
    <!-- Breadcrumb Navigation -->
    <!-- <nav class="breadcrumb-nav" aria-label="Breadcrumb">
      <div class="breadcrumb-container">
        <ol class="breadcrumb-list">
          <li class="breadcrumb-item">
            <a href="/" class="breadcrumb-link">Home</a>
          </li>
          <li class="breadcrumb-separator" aria-hidden="true">/</li>
          <li class="breadcrumb-item">
            <a href="/trips" class="breadcrumb-link">Trips</a>
          </li>
          <li class="breadcrumb-separator" aria-hidden="true">/</li>
          <li class="breadcrumb-item breadcrumb-current" aria-current="page">
            <span class="breadcrumb-text">{title}</span>
          </li>
        </ol>
      </div>
    </nav> -->

    <!-- Trip Content Sections -->
    <div class="trip-content">
      <!-- Trip Header Section -->
      <section class="trip-section trip-header-section">
        <slot name="header" />
      </section>

      <!-- Combined Stats and Map Section (when using side-by-side layout) -->
      <section class="trip-section trip-stats-map-section">
        <slot name="stats-map" />
      </section>

      <!-- Trip Stats Section (when using separate layout) -->
      <section class="trip-section trip-stats-section">
        <slot name="stats" />
      </section>

      <!-- Trip Map Section (when using separate layout) -->
      <section class="trip-section trip-map-section">
        <slot name="map" />
      </section>

      <!-- Trip Gallery Section -->
      <section class="trip-section trip-gallery-section">
        <slot name="gallery" />
      </section>

      <!-- Trip Activities Section -->
      <section class="trip-section trip-activities-section">
        <slot name="activities" />
      </section>

      <!-- Trip Participants Section -->
      <section class="trip-section trip-participants-section">
        <slot name="participants" />
      </section>

      <!-- Default content slot for any additional content -->
      <section class="trip-section trip-additional-content">
        <slot />
      </section>
    </div>
  </div>
</BaseLayout>

<style>
  .trip-layout {
    min-height: 100vh;
  }

  /* Breadcrumb Navigation */
  .breadcrumb-nav {
    background-color: #f9fafb;
    border-bottom: 1px solid #e5e7eb;
    padding: 0.75rem 0;
  }

  .breadcrumb-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .breadcrumb-list {
    display: flex;
    align-items: center;
    list-style: none;
    margin: 0;
    padding: 0;
    font-size: 0.875rem;
  }

  .breadcrumb-item {
    display: flex;
    align-items: center;
  }

  .breadcrumb-link {
    color: #6b7280;
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .breadcrumb-link:hover {
    color: #2563eb;
    text-decoration: underline;
  }

  .breadcrumb-separator {
    margin: 0 0.5rem;
    color: #9ca3af;
    font-weight: 300;
  }

  .breadcrumb-current .breadcrumb-text {
    color: #374151;
    font-weight: 500;
  }

  /* Trip Content Layout */
  .trip-content {
    /* Remove max-width constraint to allow full-width header */
  }

  .trip-section {
    margin-bottom: 3rem;
  }

  /* Specific section styling */
  .trip-header-section {
    margin-bottom: 0;
    padding: 0;
  }

  .trip-stats-map-section {
    margin-bottom: 3rem;
  }

  .trip-stats-section {
    padding: 2rem 1rem;
    background-color: #ffffff;
    max-width: 1200px;
    margin: 0 auto;
  }

  .trip-map-section {
    padding: 0 1rem 2rem;
    max-width: 1200px;
    margin: 0 auto;
  }

  .trip-gallery-section {
    padding: 2rem 1rem;
    background-color: #f9fafb;
    max-width: 1200px;
    margin: 0 auto;
  }

  .trip-activities-section {
    padding: 2rem 1rem;
    background-color: #ffffff;
    max-width: 1200px;
    margin: 0 auto;
  }

  .trip-participants-section {
    padding: 2rem 1rem;
    background-color: #f9fafb;
    max-width: 1200px;
    margin: 0 auto;
  }

  .trip-additional-content {
    padding: 2rem 1rem;
    max-width: 1200px;
    margin: 0 auto;
  }

  /* Remove margin from last section */
  .trip-section:last-child {
    margin-bottom: 0;
  }

  /* Section headers styling (for when components add their own headers) */
  .trip-section :global(h2) {
    font-size: 1.875rem;
    font-weight: 700;
    color: #1f2937;
    margin: 0 0 1.5rem 0;
    text-align: center;
  }

  .trip-section :global(h3) {
    font-size: 1.5rem;
    font-weight: 600;
    color: #374151;
    margin: 0 0 1rem 0;
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .breadcrumb-container {
      padding: 0 0.75rem;
    }

    .breadcrumb-list {
      font-size: 0.8rem;
    }

    .breadcrumb-separator {
      margin: 0 0.375rem;
    }

    .trip-section {
      margin-bottom: 2rem;
    }

    .trip-stats-section,
    .trip-map-section,
    .trip-gallery-section,
    .trip-activities-section,
    .trip-participants-section,
    .trip-additional-content {
      padding-left: 0.75rem;
      padding-right: 0.75rem;
    }

    .trip-section :global(h2) {
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    .trip-section :global(h3) {
      font-size: 1.25rem;
    }
  }

  @media (max-width: 480px) {
    .breadcrumb-container {
      padding: 0 0.5rem;
    }

    .breadcrumb-list {
      font-size: 0.75rem;
    }

    .breadcrumb-separator {
      margin: 0 0.25rem;
    }

    .trip-stats-section,
    .trip-map-section,
    .trip-gallery-section,
    .trip-activities-section,
    .trip-participants-section,
    .trip-additional-content {
      padding-left: 0.5rem;
      padding-right: 0.5rem;
    }

    .trip-section :global(h2) {
      font-size: 1.375rem;
    }

    .trip-section :global(h3) {
      font-size: 1.125rem;
    }
  }

  /* Print styles */
  @media print {
    .breadcrumb-nav {
      display: none;
    }

    .trip-section {
      break-inside: avoid;
      margin-bottom: 1.5rem;
    }

    .trip-gallery-section,
    .trip-stats-section,
    .trip-activities-section,
    .trip-participants-section {
      background-color: transparent !important;
    }
  }
</style>

<script>
  // Handle header transparency on scroll for full viewport trip pages
  document.addEventListener('DOMContentLoaded', () => {
    const header = document.querySelector('.site-header');
    const tripHeader = document.querySelector('.trip-header');
    
    if (header && tripHeader) {
      let ticking = false;
      
      const updateHeader = () => {
        const scrollY = window.scrollY;
        const tripHeaderHeight = tripHeader.offsetHeight;
        
        // Add scrolled class when scrolled past 50% of trip header
        if (scrollY > tripHeaderHeight * 0.5) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
        
        ticking = false;
      };
      
      const onScroll = () => {
        if (!ticking) {
          requestAnimationFrame(updateHeader);
          ticking = true;
        }
      };
      
      window.addEventListener('scroll', onScroll, { passive: true });
      
      // Initial check
      updateHeader();
    }
  });
</script>
